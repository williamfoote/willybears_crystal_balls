
YUI.add('ysf-watchlist',(function(){var WatchListClass=null;return function(Y){Y.namespace('Fantasy');if(WatchListClass===null){function Watchlist(cfg){if(Y.Fantasy.Watchlist._instance){return Y.Fantasy.Watchlist._instance;}
Watchlist.superclass.constructor.apply(this,arguments);Y.Fantasy.Watchlist._instance=this;}
Watchlist.NAME='watchlist';Watchlist.ATTRS={'callbackObj':{'value':{'success':function(tid,conn){var el,replacements,textStrings,rules,jsontext,jsonobj,x,y,objAr,curplayer,player_id,league_id,classname,url,elname,watchIcons,curIcon,img,errors,connObj=conn?this.parseResponse(tid,conn):null;if(!Y.Lang.isObject(connObj)){if(conn.status===0||conn.statusText==='Unknown'){el=Y.Fantasy.XHR.getTransaction(tid);url=el.getAttribute('href');window.location=url;}}
try{el=Y.Fantasy.XHR.getTransaction(tid);replacements={'class':['watchw','watchn'],'url':['addplayerwatch','deleteplayerswatch'],'param':['apid','dpids[]']};textStrings={'watchn':{title:'Remove from Watch List',img:'https://s.yimg.com/lq/i/us/sp/fn/default/full/watching_2.gif',src:'&#xe023;'},'watchw':{title:'Add to Watch List',img:'https://s.yimg.com/lq/i/us/sp/fn/default/full/not_watching_2.gif',src:'&#xe061;'}};rules={'watchw':[0,1],'watchn':[1,0]};jsontext=conn.responseText;jsonobj=Y.JSON.parse(jsontext);errors=jsonobj.errors||[];objAr=jsonobj.objects;if(errors.length>0){var tout=new Y.Fantasy.Tout();Y.each(errors,function(error){tout.displayTout({'message':error.title.replace('&nbsp;',' '),'error':true});});}else{for(x in objAr){curplayer=objAr[x];player_id=curplayer.player_id;league_id=curplayer.league_id;classname=(curplayer.status==='watching')?'watchn':'watchw';url=curplayer.url.replace(/\&ajaxrequest(\[\])?=\d/g,'');elname='w-'+league_id+'-'+player_id;watchIcons=document.getElementsByName(elname);for(y=0;y<watchIcons.length;y+=1){curIcon=watchIcons[y];curIcon.className=curIcon.className.replace(/watchw[wn]/,classname);curIcon.href=url;img=curIcon.getElementsByTagName('img')[0];if(img!==undefined){img.src=textStrings[classname].img;img.title=textStrings[classname].title;img.alt=textStrings[classname].title;}else{curIcon.title=textStrings[classname].title;curIcon.innerHTML=textStrings[classname].src;}}}}}catch(err){Y.log(err);}},'failure':function(tid,conn){if(conn.status===1223){this.success(conn);return;}
el=Y.Fantasy.XHR.getTransaction(tid);url=el.getAttribute('href');window.location=url;}}},'triggerHandler':{'value':function(e,obj){var pid,href,remUrl,linked;pid=this.getAttribute('name');href=this.getAttribute('href');remUrl=/\&?done=[^\&]+/g;href=href.replace(remUrl,'');linked=Y.Fantasy.XHR.fetchFromAjax(href,obj.get('callbackObj'),this,obj,false);if(linked){try{e.preventDefault();}catch(err){e.preventDefault();return false;}}}}};Y.extend(Watchlist,Y.Fantasy.XHR,{'register':function(){if(!this.get('isRegistered')){this.set('isRegistered',true);Y.one('body').delegate('click',this.get('triggerHandler'),'a.watchw, a.watchn',null,this);}}},{'getInstance':function(){return Y.Fantasy.Watchlist._instance||new Y.Fantasy.Watchlist();},'_instance':null});WatchListClass=Watchlist;}
Y.Fantasy.Watchlist=WatchListClass;};})(),'0.1',{'requires':['ysf-xhr','ysf-tout']});