
YUI.add('ysf-form',function(Y){Y.namespace('Fantasy');Y.Fantasy.Form=function(cfg){this.handles={};Y.Fantasy.Form.superclass.constructor.apply(this,arguments);};Y.Fantasy.Form.NAME='YSFForm';Y.Fantasy.Form.ATTRS={strings:{value:{classes:{'cta':'ysf-cta','save':'ysf-cta-save','reset':'ysf-cta-reset','cancel':'ysf-cta-cancel','done':'ysf-cta-done','proceed':'ysf-cta-proceed','cta_disabled':'ysf-cta-disabled'}}},formNode:{valueFn:function(){if(this.get('contentBox').get('nodeName')==='FORM'){return this.get('contentBox');}},writeOnce:true},formSubmitFn:{value:null}};Y.extend(Y.Fantasy.Form,Y.Widget,{initializer:function(){var formNode=this.get('formNode'),formEl=null;if(!formNode){this.destroy();return null;}
formEl=Y.Node.getDOMNode(formNode);this.set('formSubmitFn',formEl.submit);formEl.submit=function(){return false;};Y.on('submit',function(e){e.halt();},formNode);this.render();},renderUI:function(){},bindUI:function(){var formNode=this.get('formNode'),oForm=this;this.handles.onClick=formNode.on('click',this.onSubmit,oForm);this.handles.onKeyPress=formNode.on('keyPress',this.onSubmit,oForm);this.handles.onSave=this.publish('save',{'emitFacade':true,'defaultFn':this.onSave});this.handles.onReset=this.publish('reset',{'emitFacade':true,'defaultFn':this.onReset});this.handles.onCancel=this.publish('cancel',{'emitFacade':true,'defaultFn':this.onReset});this.handles.onDone=this.publish('done',{'emitFacade':true,'defaultFn':this.onDone});this.handles.onProceed=this.publish('proceed',{'emitFacade':true,'defaultFn':this.onProceed});this.handles.onSubmit=this.publish('submit',{'emitFacade':true,'defaultFn':this.submit});},onSubmit:function(e){var targetNode=e.target,strings=this.get('strings'),cta_class=strings.classes.cta,ctaNode=(targetNode.hasClass(cta_class))?targetNode:targetNode.ancestor(function(n){return n.hasClass(cta_class);});if(ctaNode&&ctaNode.hasClass(strings.classes.save)){this.fire('save');}else if(ctaNode&&ctaNode.hasClass(strings.classes.reset)){this.fire('reset');}else if(ctaNode&&ctaNode.hasClass(strings.classes.cancel)){this.fire('cancel');}else if(ctaNode&&ctaNode.hasClass(strings.classes.done)){this.fire('done');}else if(ctaNode&&ctaNode.hasClass(strings.classes.proceed)){this.fire('proceed');}},onSave:function(e){this.fire('submit');},onReset:function(e){this.fire('submit');},onCancel:function(e){this.fire('submit');},onDone:function(e){this.fire('submit');},onProceed:function(e){this.fire('submit');},disableCtas:function(type){var oForm=this,contentBox=this.get('contentBox'),strings=this.get('strings'),ctaNodes=null;if(type==='all'){ctaNodes=contentBox.all('.'+strings.classes.cta);}else{ctaNodes=contentBox.all('.'+strings.classes[type]);}
if(ctaNodes){ctaNodes.each(function(n,i,nl){oForm.disableCta(n);});}},enableCtas:function(type){var oForm=this,contentBox=this.get('contentBox'),strings=this.get('strings'),ctaNodes=null;if(type==='all'){ctaNodes=contentBox.all('.'+strings.classes.cta);}else{ctaNodes=contentBox.all('.'+strings.classes[type]);}
if(ctaNodes){ctaNodes.each(function(n,i,nl){oForm.enableCta(n);});}},disableCta:function(n){var strings=this.get('strings');n.addClass(strings.classes.cta_disabled);if(n.hasClass(strings.classes.save)){n.replaceClass('ysf-cta-in-page-submit-active','ysf-cta-in-page-submit');}},enableCta:function(n){var strings=this.get('strings');n.removeClass(strings.classes.cta_disabled);if(n.hasClass(strings.classes.save)){n.replaceClass('ysf-cta-in-page-submit','ysf-cta-in-page-submit-active');}},submit:function(e){if(!this.get('disabled')){var formNode=this.get('formNode'),formEl=Y.Node.getDOMNode(formNode);formEl.submit=this.get('formSubmitFn');formEl.submit();}},syncUI:function(){},destructor:function(){}});},'',{requires:['widget']});